CREATE TABLE secondhouselog_csv (
  device_id STRING,
  context_id STRING,
  city STRING,
  login_account STRING,
  start_time STRING,
  end_time STRING,
  content STRING,
  object_id STRING,
  context STRING,
  secondhouse_id STRING,
  esta_x STRING,
  district_x STRING,
  address_x STRING,
  streetid_x STRING,
  blockid STRING,
  blockshowname STRING,
  purpose STRING,
  structure STRING,
  buildtype STRING,
  buildyear   INT,
  buildarea   DOUBLE,
  subfloor    INT,
  floor       INT,
  totalfloor  INT,
  room        INT,
  hall        INT,
  toilet      INT,
  kitchen     INT,
  balcony     INT,
  forward STRING,
  price       DOUBLE,
  averprice_x DOUBLE,
  environment STRING,
  traffic STRING,
  fitment STRING,
  serverco STRING,
  contactor STRING,
  telno STRING,
  mobile STRING,
  creattime STRING,
  updatetime STRING,
  expiretime STRING,
  city_name STRING,
  block_id STRING,
  blockname STRING,
  district_y STRING,
  streetid_y STRING,
  area STRING,
  address_y STRING,
  bus STRING,
  averprice_y DOUBLE,
  updateprice STRING,
  forumid STRING,
  newhouseid STRING,
  b_map_x STRING,
  b_map_y STRING,
  accuracy STRING,
  map_test STRING,
  b_property_type STRING,
  b_green STRING,
  b_parking STRING,
  b_developers STRING,
  b_property_company STRING,
  b_property_fees STRING,
  b_bus STRING,
  b_metro STRING,
  b_num STRING,
  bi_s STRING,
  bi_spell STRING,
  subway STRING,
  sitename STRING,
  subwayrange STRING,
  app STRING,
  esta_y STRING,
  property_fees STRING,
  nofee STRING,
  plot_ratio STRING,
  total_room STRING,
  turn_time STRING,
  b_area STRING,
  feature STRING
)COMMENT 'This is second house table csv'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|';


CREATE TABLE secondhouselog(
  device_id STRING,
  context_id STRING,
  city STRING,
  login_account STRING,
  start_time STRING,
  end_time STRING,
  content STRING,
  object_id STRING,
  context STRING,
  secondhouse_id STRING,
  esta_x STRING,
  district_x STRING,
  address_x STRING,
  streetid_x STRING,
  blockid STRING,
  blockshowname STRING,
  purpose STRING,
  structure STRING,
  buildtype STRING,
  buildyear   INT,
  buildarea   DOUBLE,
  subfloor    INT,
  floor       INT,
  totalfloor  INT,
  room        INT,
  hall        INT,
  toilet      INT,
  kitchen     INT,
  balcony     INT,
  forward STRING,
  price       DOUBLE,
  averprice_x DOUBLE,
  environment STRING,
  traffic STRING,
  fitment STRING,
  serverco STRING,
  contactor STRING,
  telno STRING,
  mobile STRING,
  creattime STRING,
  updatetime STRING,
  expiretime STRING,
  city_name STRING,
  block_id STRING,
  blockname STRING,
  district_y STRING,
  streetid_y STRING,
  area STRING,
  address_y STRING,
  bus STRING,
  averprice_y DOUBLE,
  updateprice STRING,
  forumid STRING,
  newhouseid STRING,
  b_map_x STRING,
  b_map_y STRING,
  accuracy STRING,
  map_test STRING,
  b_property_type STRING,
  b_green STRING,
  b_parking STRING,
  b_developers STRING,
  b_property_company STRING,
  b_property_fees STRING,
  b_bus STRING,
  b_metro STRING,
  b_num STRING,
  bi_s STRING,
  bi_spell STRING,
  subway STRING,
  sitename STRING,
  subwayrange STRING,
  app STRING,
  esta_y STRING,
  property_fees STRING,
  nofee STRING,
  plot_ratio STRING,
  total_room STRING,
  turn_time STRING,
  b_area STRING,
  feature STRING
)partitioned by (data_date string)
COMMENT 'This is second house log table'
STORED AS PARQUET;

insert into user_track.secondhouselog_back partition(data_date='{}') select device_id,context_id,city,login_account,start_time,end_time,content,object_id,context,secondhouse_id,esta_x,district_x,address_x,streetid_x,blockid,blockshowname,purpose,structure,buildtype,buildyear,buildarea,subfloor,floor,totalfloor,room,hall,toilet,kitchen,balcony,forward,price,averprice_x,environment,traffic,fitment,serverco,contactor,telno,mobile,creattime,updatetime,expiretime,city_name,block_id,blockname,district_y,streetid_y,area,address_y,bus,averprice_y,updateprice,forumid,newhouseid,b_map_x,b_map_y,accuracy,map_test,b_property_type,b_green,b_parking,b_developers,b_property_company,b_property_fees,b_bus,b_metro,b_num,bi_s,bi_spell,subway,sitename,subwayrange,app,esta_y,property_fees,nofee,plot_ratio,total_room,turn_time,b_area,feature from user_track.secondhouselog where data_date='{}'





